@model List<SubscriptionProductA>
@{
    ViewBag.Title = "Subscribe - TFC.tv";
    Layout = "~/Views/Shared/_UXUpdate.cshtml";

    List<TFCTV.Helpers.CreditCard> CreditCardList = null;
    System.Collections.ArrayList MonthList = null;
    System.Collections.ArrayList YearList = null;
    bool CreditCardAvailability = true;
    bool InsufficientWalletBalance = false;
    var listOfIncludedProductIds = MyUtility.StringToIntList(GlobalConfig.ProductIdsIncludedInRecurringBilling);
    TransactionReturnType ErrorMessage = null;
    bool IsFirstTimeSubscriber = false;
    try
    {
        if (ViewBag.CreditCardList != null)
        {
            CreditCardList = ViewBag.CreditCardList;
        }
        if (ViewBag.CreditCardAvailability != null)
        {
            CreditCardAvailability = ViewBag.CreditCardAvailability;
        }

        if (ViewBag.Months != null)
        {
            MonthList = ViewBag.Months;
        }
        if (ViewBag.Years != null)
        {
            YearList = ViewBag.Years;
        }
        if (TempData["ErrorMessage"] != null)
        {
            ErrorMessage = (TransactionReturnType)TempData["ErrorMessage"];
        }
        if (ViewBag.InsufficientWalletBalance != null)
        {
            InsufficientWalletBalance = ViewBag.InsufficientWalletBalance;
        }
        if (ViewBag.IsFirstTimeSubscriber != null)
        {
            IsFirstTimeSubscriber = ViewBag.IsFirstTimeSubscriber;
        }
    }
    catch (Exception) { }

    //promo 2014
    bool IsPromo2014 = false;
    IPTV2_Model.ProductPrice Premium1MonthPrice = null;
    //Project Black
    bool isProjectBlack = false;
    IPTV2_Model.ProductPrice Premium3MonthPrice = null;
    bool isAPRBoxDisabled = false;
    string page_Description = "Be part of history! TFC exclusively brings to the Middle East what is dubbed as the “FIGHT OF THE CENTURY” happening on May 3, 2015, 4am KSA and 5am UAE. SUBSCRIBE NOW!";
    bool xoomPage = false;

    bool IsPacMay = false;
    try
    {
        if (ViewBag.IsPromo2014 != null)
        {
            IsPromo2014 = ViewBag.IsPromo2014;
        }
        if (ViewBag.Premium1MonthPrice != null)
        {
            Premium1MonthPrice = ViewBag.Premium1MonthPrice;
        }
        if (ViewBag.isProjectBlack != null)
        {
            isProjectBlack = ViewBag.isProjectBlack;
        }
        if (ViewBag.Premium3MonthPrice != null)
        {
            Premium3MonthPrice = ViewBag.Premium3MonthPrice;
        }
        if (ViewBag.IsAPRBoxDisabled != null)
        {
            isAPRBoxDisabled = ViewBag.IsAPRBoxDisabled;
        }
        if (ViewBag.PageDescription != null)
        {
            page_Description = ViewBag.PageDescription;
        }
        if (TempData["xoom"] != null)
        {
            xoomPage = (bool)TempData["xoom"];
        }
        if (ViewBag.IsPacMay != null)
        {
            IsPacMay = ViewBag.IsPacMay;
        }
    }
    catch (Exception) { }

    //PacyMay
    var ip = Request.IsLocal ? "78.95.139.99" : Request.GetUserHostAddressFromCloudflare();
    if (GlobalConfig.isUAT && !String.IsNullOrEmpty(Request.QueryString["ip"]))
    {
        ip = Request.QueryString["ip"].ToString();
    }
    var location = MyUtility.GetLocationBasedOnIpAddress(ip);

}
<section class="page_pagebody page_registration page_sub page_subscription">
    <!--  subscription page body -->
    <div class="container">
        <!-- subscription page top -->
        <div class="row">
            <div class="reg_hleft col-md-9 col-sm-8 col-xs-12">
                <h1 class="page_title_black2">
                    Subscribe NOW! Exclusive offer from TFC.tv ONLY!
                </h1>
            </div>
            <div class="reg_hright col-md-3 col-sm-4 hidden-xs">
                <span class="siteseal">
                    <script type="text/javascript" src="https://seal.godaddy.com/getSeal?sealID=fZ0cB9nrBGjhlW5r6DJKXUD9NE0tNx0WddTWSOxEMItms6df4AAc"></script>
                </span>
            </div>
            <div class="col-xs-12 page_description">
                @page_Description
            </div>
        </div>
        <!-- end top -->
        <!-- offer boxes -->
        <div class="row offerboxs active">
            <div class="col-xs-12">
                <!-- sub title -->
                <h2 class="graw_subtitle">
                    <span class="glyphicon glyphicon-chevron-right bgi"></span>Select a plan that works
                    for you:
                </h2>
            </div>
            <!-- END sub title -->
            @{if (Model != null)
            {
                if (Model.Count() > 0)
                {
                    int ctr = 0;
                    foreach (var item in Model)
                    {
                        string custom = String.Format("{0}&{1}&{2}&{3}&{4}", item.product.ProductId, ContextHelper.GetProductType(item.product).ToString(), ViewBag.WishlistId, ViewBag.CurrentProductId, User.Identity.Name);
                        string amount = item.productPrice.Amount.ToString("F");
                        string id = String.Format("offbox{0}", item.product.ProductId);
                        /* regular product*/
                        string p3 = String.Empty;
                        string t3 = String.Empty;
                        string a3 = String.Empty;

                        /* free/discounted product */
                        string p1 = String.Empty;
                        string t1 = String.Empty;
                        string a1 = String.Empty;

                        bool IsSubscriptionProduct = false;

                        //for Paypal
                        bool IsPayPalSupported = true;
                        string paypal_amount = amount;
                        string a1_paypal_amount = amount;
                        string paypal_currency_code = item.productPrice.CurrencyCode;
                        string data_a3 = String.Empty;
                        string data_a1 = String.Empty;
                        string trial_product_price = String.Empty;
                        string regular_product_price = String.Empty;
                        try
                        {
                            if (item.product is IPTV2_Model.SubscriptionProduct)
                            {
                                var subscriptionProduct = (IPTV2_Model.SubscriptionProduct)item.product;
                                if (item.freeProduct != null)
                                {
                                    p1 = item.freeProduct.Duration.ToString();
                                    t1 = item.freeProduct.DurationType.ToUpper();
                                    a1 = item.freeProductPrice.Amount.ToString("F");

                                    p3 = subscriptionProduct.Duration.ToString();
                                    t3 = subscriptionProduct.DurationType.ToUpper();
                                    a3 = amount;

                                    custom = String.Format("{0}&{1}&{2}&{3}&{4}&{5}&xoom", item.product.ProductId, ContextHelper.GetProductType(item.product).ToString(), ViewBag.WishlistId, ViewBag.CurrentProductId, User.Identity.Name, item.freeProduct.ProductId);
                                }
                                else if (item.regularProduct != null && item.product.IsRecurring == GlobalConfig.Visible)
                                {
                                    p1 = subscriptionProduct.Duration.ToString();
                                    t1 = subscriptionProduct.DurationType.ToUpper();
                                    a1 = amount;
                                    a1_paypal_amount = amount;

                                    p3 = item.regularProduct.Duration.ToString();
                                    t3 = item.regularProduct.DurationType.ToUpper();
                                    a3 = item.regularProductPrice.Amount.ToString("F");
                                    paypal_amount = a3;
                                    custom = String.Format("{0}&{1}&{2}&{3}&{4}&{5}", item.product.ProductId, ContextHelper.GetProductType(item.product).ToString(), ViewBag.WishlistId, ViewBag.CurrentProductId, User.Identity.Name, item.regularProduct.ProductId);
                                }
                                else
                                {
                                    p3 = subscriptionProduct.Duration.ToString();
                                    t3 = subscriptionProduct.DurationType.ToUpper();
                                    a3 = amount;

                                    a1 = String.Empty;
                                    p1 = String.Empty;
                                    t1 = String.Empty;
                                }
                                var litepromo = MyUtility.StringToIntList(GlobalConfig.LitePromoProductIds);
                                try
                                {
                                    IsSubscriptionProduct = Convert.ToBoolean(item.product.IsRecurring);
                                }
                                catch (Exception)
                                {
                                    if (item.product is IPTV2_Model.PackageSubscriptionProduct && !litepromo.Contains(item.product.ProductId))
                                    {
                                        if (((IPTV2_Model.PackageSubscriptionProduct)item.product).ProductGroup.ProductSubscriptionTypeId == null)
                                        {
                                            IsSubscriptionProduct = true;
                                        }
                                    }
                                }
                            }



                            if (!item.productPrice.Currency.IsPayPalSupported)
                            {
                                var product_default_currency = item.product.ProductPrices.FirstOrDefault(p => String.Compare(p.CurrencyCode, GlobalConfig.DefaultCurrency, true) == 0);
                                paypal_amount = product_default_currency.Amount.ToString("F");
                                //data_a1 = product_default_currency.Amount.ToString("F");
                                data_a3 = product_default_currency.Amount.ToString("F");
                                if (item.product.IsRecurring == GlobalConfig.Visible && item.product.RegularProductId != null)
                                {
                                    trial_product_price = product_default_currency.Amount.ToString("F");
                                }
                                else
                                {
                                    regular_product_price = product_default_currency.Amount.ToString("F");
                                }

                                paypal_currency_code = product_default_currency.CurrencyCode;
                                IsPayPalSupported = false;
                            }

                            if (!item.regularProductPrice.Currency.IsPayPalSupported)
                            {
                                var product_default_currency1 = item.regularProduct.ProductPrices.FirstOrDefault(p => String.Compare(p.CurrencyCode, GlobalConfig.DefaultCurrency, true) == 0);
                                a1_paypal_amount = product_default_currency1.Amount.ToString("F");
                                data_a1 = product_default_currency1.Amount.ToString("F");
                                regular_product_price = product_default_currency1.Amount.ToString("F");
                                paypal_currency_code = product_default_currency1.CurrencyCode;
                                IsPayPalSupported = false;
                            }

                        }
                        catch (Exception) { }
                        <input type="radio" name="offbox" class="offbox hide" id="@id" required />
                        <label class="col-sm-4 col-xs-12 offerbox" for="@id" data-pid="@item.product.ProductId" data-custom="@Html.Raw(HttpUtility.UrlEncode(custom))" data-item_name="@item.product.Description" data-amount="@String.Format("{0}", IsPayPalSupported ? amount : paypal_amount)" data-currency_code="@String.Format("{0}", IsPayPalSupported ? item.productPrice.CurrencyCode : paypal_currency_code)" data-p3="@p3" data-t3="@t3" data-a3="@String.Format("{0}", IsPayPalSupported ? a3 : regular_product_price)" data-cmd="@String.Format("{0}", IsSubscriptionProduct ? "_xclick-subscriptions" : "_xclick")" data-recur="@String.Format("{0}", IsSubscriptionProduct ? "true" : "false")" data-p1="@p1" data-t1="@t1" data-a1="@String.Format("{0}", IsPayPalSupported ? a1 : trial_product_price)" data-allowed="@String.Format("{0}", item.IsUserEnrolledToSameRecurringPackage ? "true" : "false")">
                            <!-- box 1 -->
                            <div class="inner">
                                <h3 class="@String.Format("box_title{0}", IsPacMay ? "1" : String.Empty)">
                                    @Html.Raw(item.product.Description)
                                </h3>
                                @{if (IsPromo2014)
                                {
                                    <p class="promo_highlight">
                                        Enjoy <em>unlimited</em><br />
                                        ABS-CBN<br />
                                        shows ALL DAY,<br />
                                        EVERYDAY!
                                    </p>
                                }
                                else if (isProjectBlack)
                                {
                                    <p>
                                        <span class="promo_f20 strike">@String.Format("{0} {1} for {2}", Premium1MonthPrice.CurrencyCode, (Premium1MonthPrice.Amount * 3).ToString("F"), MyUtility.FormatDuration(item.product.DurationType, item.product.Duration))</span>
                                        <br />
                                        <span class="promo_amount_text">@String.Format("ONLY {0} {1}", item.productPrice.CurrencyCode, amount)</span>
                                        <br />
                                        <span class="promo_highlight fs_24px">@String.Format("(Save {0} {1})", item.productPrice.CurrencyCode, item.productPrice.DiscountAmount.ToString("F"), (item.productPrice.DiscountPercentage * 100).ToString("0"))</span>
                                    </p>
                                    <span class="ib_off">@String.Format("{0}% OFF", (item.productPrice.DiscountPercentage * 100).ToString("0"))</span>
                                }
                                else if (IsPacMay)
                                {
                                    var additional_product_ids = MyUtility.StringToIntList(GlobalConfig.PacMaySubscribeProductIds);
                                    if (additional_product_ids.Contains(item.product.ProductId))
                                    {
                                        <div class="cont">
                                            <br />
                                            <p>
                                                Pay Per View - LIVE EVENT<br />
                                                <span class="small-text">(Mayweather vs Pacquiao Battle for Greatness 2015)</span> <span class="plus">+</span>
                                                @*Video on Demand (VOD) <span class="small-text">for 48 hours</span>*@
                                                Replays
                                                <span class="plus">+</span>1-month Premium Subscription<br /><span class="small-text">(enrolled in Automatic Payment Renewal)</span>
                                                <span class="plus">+</span>Online Movie Premiere - KID KULAFU <span class="small-text">for 48 hours</span>
                                            </p>
                                        </div>
                                    }
                                    else
                                    {
                                        <div class="cont">
                                            <br />
                                            <p>
                                                Pay Per View - LIVE EVENT<br />
                                                <span class="small-text">(Mayweather vs Pacquiao Battle for Greatness 2015)</span> <span class="plus">+</span>
                                                @*Video on Demand (VOD) <span class="small-text">for 48 hours</span>*@
                                                Replays
                                            </p>
                                        </div>
                                    }

                                }
                                else
                                {
                                    <p>
                                        @{if (!String.IsNullOrEmpty(item.contentDescription))
                                        {
                                            @String.Format("{0} Titles", item.contentDescription)
                                            if (item.ListOfDescription != null)
                                            {
                                                if (item.ListOfDescription.Count() > 0)
                                                {
                                                    foreach (var lItem in item.ListOfDescription.Take(item.ListOfDescription.Count() - 1))
                                                    {
                                                        <text>
                                                        <p class="sub_p">
                                                            - @Html.Raw(lItem)
                                                        </p>
                                                        </text>
                                                    }
                                                }
                                            }
                                        }
                                        else if (!String.IsNullOrEmpty(item.ShowDescription))
                                        {
                                            @String.Format("{0}", item.show.Description)
                                        }
                                        }
                                        </p>
                                }
                                }
                                <div class="box_border">
                                </div>
                                @{if (IsPromo2014)
                                {
                                    <p>
                                        <span class="promo_f24">For a limited time only!</span>
                                        <br />
                                        <span class="promo_f20 strike">@String.Format("{0} {1} for {2}", Premium1MonthPrice.CurrencyCode, (Premium1MonthPrice.Amount * 3).ToString("F"), MyUtility.FormatDuration(item.product.DurationType, item.product.Duration))</span>
                                        <br />
                                        <span class="promo_amount_text">@String.Format("ONLY {0} {1}", item.productPrice.CurrencyCode, amount)</span>
                                        <br />
                                        <span class="promo_f24">@String.Format("for {0}.*", MyUtility.FormatDuration(item.product.DurationType, item.product.Duration))</span><br />
                                        @String.Format("(Save {0} {1})", item.productPrice.CurrencyCode, item.productPrice.DiscountAmount.ToString("F"), (item.productPrice.DiscountPercentage * 100).ToString("0"))
                                    </p>
                                    <span class="ib_off">@String.Format("{0}% OFF", (item.productPrice.DiscountPercentage * 100).ToString("0"))</span>
                                }
                                else if (isProjectBlack)
                                {
                                    <p class="promo_f24">
                                        Enjoy <em>unlimited</em><br />
                                        ABS-CBN<br />
                                        shows ALL DAY,<br />
                                        EVERYDAY!<br />
                                        <br />
                                        Limited time offer!
                                    </p>
                                }
                                else if (IsPacMay)
                                {
                                    <p class="large_amount">
                                        @String.Format("ONLY {0} {1}", item.productPrice.CurrencyCode, amount)
                                    </p>
                                }
                                else
                                {
                                    <p>
                                        @String.Format("ONLY {0} {1} for {2}", item.productPrice.CurrencyCode, amount, MyUtility.FormatDuration(item.product.DurationType, item.product.Duration))
                                    </p>
                                    if (item.productPrice.DiscountAmount > 0)
                                    {
                                        <p class="highlight">
                                            @String.Format("Save {0} {1}!", item.productPrice.CurrencyCode, item.productPrice.DiscountAmount.ToString("F"), (item.productPrice.DiscountPercentage * 100).ToString("0"))
                                        </p>
                                        <span class="ib_off">@String.Format("{0}% OFF", (item.productPrice.DiscountPercentage * 100).ToString("0"))</span>
                                    }
                                    else
                                    {
                                        <p class="highlight">
                                            &nbsp;
                                        </p>
                                    }
                                }
                                }
                                @Html.ImageBuilder(Url, "ux/checked.jpg", new { @class = "Ib_checked", alt = "checked" })
                                <!-- red checked img -->
                            </div>
                        </label>
                                ctr = ctr + 1;
                    }
                }
            }
            }
        </div>
        <!-- end offer boxes container -->
        <!-- Accordion container for payment methods -->
        <div class="row signin-link">
            <div class="col-xs-12 text-right">
                @{if (Request.Browser.IsMobileDevice)
                {
                    @Html.ActionLink("Already have an account? Click here to sign in.", "MobileSignIn", "User", null, new { @class = "right_side_link" })
                }
                else
                {
                    @Html.ActionLink("Already have an account? Click here to sign in.", "Login", "User", null, new { @class = "right_side_link" })
                }}
            </div>
        </div>
        <div class="panel-group payment_panel" id="accordion">
            @{if (!User.Identity.IsAuthenticated)
            {
                <div class="row panel panel-default personal_body">
                    <!-- Credit card section -->
                    <div class="col-xs-12 panel-heading">
                        <!-- panel 1 heading -->
                        <a id="personal_body_anchor" class="tab_anchor">
                            <h2 class="graw_subtitle panel-title" data-toggle="collapse" data-target="#personal_body"
                                data-parent="#accordion">
                                <span class="glyphicon glyphicon-chevron-right bgi"></span>Personal Information
                            </h2>
                        </a>
                    </div>
                    <!-- END panel 1 heading -->
                    <!-- panel 1 body -->
                    <div class="col-xs-12 panel-collapse collapse in" id="personal_body">
                        <div class="alert alert-danger alert_pacmay hide">
                            <a class="close" data-hide="alert">×</a> <span class="err_msg"></span>
                        </div>
                        <form id="register_form" name="register_form" method="post" action="@Url.Action("_RegisterAndSubscribe", "User",null, "https")">
                            @Html.AntiForgeryToken()
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <input type="email" class="form-control" id="p_login_email" name="p_login_email" value="" maxlength="64" placeholder="Email Address" required>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <input type="email" class="form-control" id="p_login_email_c" name="p_login_email_c" autocomplete="off" required placeholder="Confirm Email Address">
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                    <span id="msg_confirm_email"></span>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <input type="password" class="form-control" id="login_pass" name="login_pass" placeholder="Choose a Password..."
                                               required>
                                    </div>
                                </div>
                                <div class="col-sm-4">
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-4">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="first_name" name="first_name" value="" maxlength="32" placeholder="First Name" required>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="last_name" name="last_name" value="" maxlength="32" placeholder="Last Name" required>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-sm-2">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="city" value="@location.city" name="city" maxlength="50" placeholder="City" readonly required>
                                    </div>
                                </div>
                                <div class="col-sm-2">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="state" value="@location.regionName" name="state" maxlength="50" placeholder="State" readonly required>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <div class="form-group">
                                        <input type="text" class="form-control" id="country" value="@location.countryName" name="country" maxlength="50" placeholder="Country" readonly required>
                                    </div>
                                </div>
                            </div>
                            <div class="row options">
                                <!-- options [check boxs] -->
                                <div class="col-xs-12">
                                    <p class="no_margin">
                                        <input type="checkbox" class="form-control css-checkbox" id="confirm" name="confirm" required>
                                        <label for="confirm" class="css-label klaus">
                                        </label>
                                        <label for="confirm">
                                            I confirm that I have read and fully understand and accept the <a href="@Url.Action("TermsAndConditions", "Home")">
                                                Terms and Conditions of the Subscription and/or Use
                                            </a> of TFC.tv
                                        </label>
                                    </p>
                                    <input type="submit" value="YES! I want to watch the Fight!" id="register_btn" class="btn btn-primary blue_button sub_pro_msgb">
                                    <!-- popup box trigger && submit button -->
                                    <p>
                                        <span class="siteseal">
                                            <script type="text/javascript" src="https://seal.godaddy.com/getSeal?sealID=fZ0cB9nrBGjhlW5r6DJKXUD9NE0tNx0WddTWSOxEMItms6df4AAc"></script>
                                        </span>
                                    </p>
                                    <p class="note pp_note note2 no_margin">
                                        By purchasing this subscription, your PayPal account shall be enrolled to Automatic
                                        Renewal. For more information about Automatic<br>
                                        Renewal, please check our help center. To cancel Automatic Renewal, please visit
                                        Edit My Profile Page.
                                    </p>
                                </div>
                            </div>
                            <!-- END options [check boxs] -->
                            <input type="hidden" name="provider" id="provider" value="" />
                            <input type="hidden" name="uid" id="uid" value="" />
                            <input type="hidden" name="ip" value="@ip" />
                        </form>
                    </div>
                    <!-- END panel 1 body -->
                </div>  <!-- END Credit card section -->
            }
            }
            @{if (GlobalConfig.IsPaypalPaymentModeEnabled)
            {
                <div class="row panel panel-default pay_pal">
                    <!-- Pay pal section -->
                    <div class="col-xs-12 panel-heading">
                        <!-- panel 2 heading -->
                        <a id="paypal_anchor" class="tab_anchor">
                            <h2 class="graw_subtitle panel-title" data-toggle="collapse" data-target="#paypal_body"
                                data-parent="#accordion">
                                <span class="glyphicon glyphicon-chevron-right bgi"></span>Pay Pal
                                @Html.ImageBuilder(Url, "ux/paypal.jpg", new { alt = "Paypal" })
                            </h2>
                        </a>
                    </div>
                    <!-- END panel 2 heading -->
                    <!-- panel 2 body -->
                    <div class="col-xs-12 panel-collapse collapse" id="paypal_body">
                        <form id="paypal_form" name="paypal_form" target="_blank" method="post" enctype="multipart/form-data" action="@GlobalConfig.PayPalSubmitUrl">
                            <p>
                                <b>
                                    To proceed with the purchase, click on the "Continue to PayPal" button and log on
                                    using your PayPal email and password.
                                </b>
                            </p>
                            <input type="submit" value="Continue to PayPal" id="paypal_btn" class="btn btn-primary blue_button sub_pro_msgb disabled"><!-- popup box trigger && submit button -->
                            <p>
                                <span class="siteseal">
                                    <script type="text/javascript" src="https://seal.godaddy.com/getSeal?sealID=fZ0cB9nrBGjhlW5r6DJKXUD9NE0tNx0WddTWSOxEMItms6df4AAc"></script>
                                </span>
                            </p>

                            <input name="pid" value="" type="hidden" />
                            <input type="hidden" name="cmd" value="_xclick" />
                            <input type="hidden" name="a1" value="" />
                            <input type="hidden" name="p1" value="" />
                            <input type="hidden" name="t1" value="" />
                            <input type="hidden" name="a3" value="" />
                            <input type="hidden" name="p3" value="" />
                            <input type="hidden" name="t3" value="" />
                            <input type="hidden" name="src" value="1" />
                            <input type="hidden" name="business" value="@GlobalConfig.PayPalBusiness" />
                            <input type="hidden" name="item_name" value="" />
                            <input type="hidden" name="amount" value="" />
                            <input type="hidden" name="currency_code" value="" />
                            <input type="hidden" name="return" value="@GlobalConfig.PayPalReturnUrl" />
                            <input type="hidden" name="custom" value="" />
                            <input type="hidden" name="no_shipping" value="1" />
                        </form>
                    </div>
                    <!-- END panel 2 body -->
                </div>
                <!-- END Pay pal section -->
            }
            }
            @{if (GlobalConfig.IsPpcPaymentModeEnabled && !xoomPage && false)
            {
                <div class="row panel panel-default prepaid_card">
                    <!-- Prepaid card section -->
                    <div class="col-xs-12 panel-heading">
                        <!-- panel 3 heading -->
                        <a id="prepaid_card_anchor" class="tab_anchor">
                            <h2 class="graw_subtitle panel-title" data-toggle="collapse" data-target="#prepaidcard_body"
                                data-parent="#accordion">
                                <span class="glyphicon glyphicon-chevron-right bgi"></span>Prepaid Card/ePIN
                            </h2>
                        </a>
                    </div>
                    <!-- END panel 3 heading -->
                    <!-- panel 3 body -->
                    <div class="col-xs-12 panel-collapse collapse" id="prepaidcard_body">
                        @{if (ErrorMessage != null)
                        {
                            if (String.Compare(ErrorMessage.info, "PrepaidCard", true) == 0)
                            {
                                <div class="alert alert-danger">
                                    <a class="close" data-dismiss="alert">×</a> @ErrorMessage.StatusMessage
                                </div>
                            }
                        }
                        }
                        <form method="post" name="form_prepaid_Card" id="form_prepaid_Card" action="@Url.Action("_PrepaidCard", "Subscribe")">
                            @Html.AntiForgeryToken()
                            <div class="row form-group">
                                <div class="col-sm-4">
                                    <label for="serial_number">
                                        Serial Number
                                    </label>
                                    <input type="text" class="form-control" id="serial" name="serial" maxlength="20"
                                           required>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-sm-4">
                                    <label for="pin">
                                        PIN
                                    </label>
                                    <input type="text" class="form-control" id="pin" name="pin" maxlength="20" required>
                                </div>
                            </div>
                            <div class="row form-group">
                                <div class="col-xs-12">
                                    <input type="submit" value="SUBSCRIBE  Now!" class="btn btn-primary blue_button sub_pro_msgb">
                                    <!-- popup box trigger && submit button -->
                                    <p>
                                        <span class="siteseal">
                                            <script type="text/javascript" src="https://seal.godaddy.com/getSeal?sealID=fZ0cB9nrBGjhlW5r6DJKXUD9NE0tNx0WddTWSOxEMItms6df4AAc"></script>
                                        </span>
                                    </p>
                                </div>
                            </div>
                            <input name="pid" value="" type="hidden" />
                        </form>
                    </div>
                    <!-- END panel 3 body -->
                </div>
                <!-- END Prepaid card section -->
            }
            }
            @{if (GlobalConfig.IsEWalletPaymentModeEnabled && !xoomPage && false)
            {
                <div class="row panel panel-default ewallet">
                    <!-- EWallet section -->
                    <div class="col-xs-12 panel-heading">
                        <!-- panel 4 heading -->
                        <a id="ewallet_anchor" class="tab_anchor">
                            <h2 class="graw_subtitle panel-title" data-toggle="collapse" data-target="#ewallet_body"
                                data-parent="#accordion">
                                <span class="glyphicon glyphicon-chevron-right bgi"></span>E-Wallet
                            </h2>
                        </a>
                    </div>
                    <!-- END panel 4 heading -->
                    <!-- panel 4 body -->
                    <div class="col-xs-12 panel-collapse collapse" id="ewallet_body">
                        @{if (ErrorMessage != null)
                        {
                            if (String.Compare(ErrorMessage.info, "EWallet", true) == 0)
                            {
                                <div class="alert alert-danger">
                                    <a class="close" data-dismiss="alert">×</a> @ErrorMessage.StatusMessage
                                </div>
                            }
                        }
                        }
                        <form id="ewallet_form" name="ewallet_form" method="post" action="@Url.Action(String.Format("{0}", InsufficientWalletBalance ? "Index" : "_EWallet"), String.Format("{0}", InsufficientWalletBalance ? "Load" : "Subscribe"))">
                            @Html.AntiForgeryToken()
                            @{if (InsufficientWalletBalance)
                            {
                                <p>
                                    <b class="ewallet_note">
                                        You don't have enough credits to purchase this product, click
                                        on the "Purchase Credits" button to load up your E-Wallet.
                                    </b>
                                </p>
                                <a href="@Url.Action("Index", "Load")" class="btn btn-primary blue_button sub_pro_msgb ewallet_abutton blue_btn_a">
                                    Purchase Credits
                                </a>
                                <input type="submit" value="Purchase using E-Wallet" class="btn btn-primary blue_button ewallet_sbutton sub_pro_msgb hide" />
                            <!-- popup box trigger && submit button -->

                            }
                            else
                            {
                                <p>
                                    <b class="ewallet_note">
                                        To proceed with the purchase, click on the "Purchase using E-Wallet"
                                        button.
                                    </b>
                                </p>
                                <a href="@Url.Action("Index", "Load")" class="btn btn-primary blue_button sub_pro_msgb blue_btn_a ewallet_abutton hide">
                                    Purchase Credits
                                </a>
                                <input type="submit" value="Purchase using E-Wallet" class="btn btn-primary blue_button ewallet_sbutton sub_pro_msgb" /><!-- popup box trigger && submit button -->
                            }
                            }
                            <p>
                                <span class="siteseal">
                                    <script type="text/javascript" src="https://seal.godaddy.com/getSeal?sealID=fZ0cB9nrBGjhlW5r6DJKXUD9NE0tNx0WddTWSOxEMItms6df4AAc"></script>
                                </span>
                            </p>
                            <input name="pid" value="" type="hidden" />
                        </form>
                    </div>
                    <!-- END panel 4 body -->
                </div>
            }
            }
        </div>
        <!-- END Accordion container for payment methods -->
        <div class="panel-group payment_panel_error hide" id="payment_panel_error">
            <div class="alert alert-danger">
                <p class="fs_20px">
                    You are already enrolled to a similar subscription product through Automatic Payment
                    Renewal via Paypal/Credit Card.
                </p>
            </div>

            @{if (IsPacMay)
            {
                <div class="center-block-btn">
                    <a href="#" id="btnCancelRecurring"><button type="button" class="btn btn-danger red_button">Click here to cancel your Automatic Payment Renewal</button></a>
                </div>
            }
            }
        </div>
    </div>
    <!-- END Container -->
</section>
<!-- end page body section -->
<!-- popup processing message -->
<div class="modal fade" id="subProMsg" tabindex="-1" role="dialog" aria-labelledby="subProMsgLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <!-- box body -->
                <p class="boxHead boxSmaller">
                    Please do not close your browser. We are currently processing your transaction.
                </p>
            </div>
            <!-- END box body -->
        </div>
    </div>
</div>
<!-- END popup successful message -->
@section JScriptBottom {
    @Html.JsBuilder(Url, "placeholders.jquery.min.js")
    @{if (GlobalConfig.IsPaypalPaymentModeEnabled)
    {
        <script type="text/javascript">
            $(document).ready(function () {
                $('#paypal_form').submit(function (event) {
                    var form = $(this);
                    window.open('', 'paypalwindow');
                    this.target = 'paypalwindow';
                });

                $('#register_form').submit(function (event) {
                    var form = $("#register_form");
                    event.preventDefault();
                    $("#register_btn").val("PLEASE WAIT...");
                    $("#register_btn").addClass("disabled");
                    if (confirmMail()) {
                        $.ajax({
                            url: form.attr("action")
                        , data: $("#register_form").serialize()
                        , method: "POST"
                        , success: function (data) {
                            if (data.StatusCode == 0) {
                                $(".err_msg").html("");
                                $(".alert_pacmay").addClass("hide");
                                var cu = document.getElementsByName("custom")[0].value;
                                cu = unescape(cu).split("&");
                                cu[4] = data.info3;
                                document.getElementsByName("custom")[0].value = escape(cu.join("&"));
                                //$("#personal_body").collapse("hide");
                                //$("#paypal_body").collapse("show");
                                $("#personal_body").removeClass("in");
                                $("#paypal_body").addClass("in");
                                $("#paypal_btn").removeClass("disabled");
                                $("#register_btn").prop("disabled", true);
                                $("#register_btn").val("REGISTER & PAY");
                            }
                            else {
                                $(".err_msg").html(data.StatusMessage);
                                $(".alert_pacmay").removeClass("hide");
                                $("#register_btn").val("REGISTER & PAY");
                                $("#register_btn").removeClass("disabled");
                            }
                        }
                        })
                    }
                    else {
                        $(".err_msg").html("Email addresses do not match");
                        $(".alert_pacmay").removeClass("hide");
                        $("#register_btn").val("REGISTER & PAY");
                        $("#register_btn").removeClass("disabled");
                    }
                });
            });
        </script>
    }
    }

    @{if (IsPacMay)
    {
        <script type="text/javascript">
            function update_recur(visible) {
                if (visible) {
                    $('#recur_area').show();
                    $('.pp_note').show();
                    $('.payment_panel .ewallet').hide();
                    $('.payment_panel .prepaid_card').hide();
                }
                else {
                    $('#recur_area').hide();
                    $('.pp_note').hide();
                    $('.payment_panel .ewallet').show();
                    $('.payment_panel .prepaid_card').show();
                }
                $('#recur').prop('checked', visible);
            }
        </script>
    }
    else
    {
        <script type="text/javascript">
            function update_recur(visible) {
                if (visible) {
                    $('#recur_area').show();
                    $('.pp_note').show();
                }
                else {
                    $('#recur_area').hide();
                    $('.pp_note').hide();
                }
                $('#recur').prop('checked', visible);
            }
        </script>
    }}
    <script type="text/javascript">
        function checkbalance(pid) {
            $.post('/Subscribe/CheckBalance', { pid: pid }, function (data) {
                if (data.StatusCode == 0) {
                    $('.ewallet_note').text('To proceed with the purchase, click on the "Purchase using E-Wallet" button.');
                    $('.ewallet_sbutton').val('Purchase using E-Wallet');
                    $('.ewallet_sbutton').removeClass('hide').show();
                    $('.ewallet_abutton').hide();
                }
                else {
                    $('.ewallet_note').text('You don\'t have enough credits to purchase this product, click on the "Purchase Credits" button to load up your E-Wallet.');
                    $('.ewallet_sbutton').val('Purchase Credits');
                    $('.ewallet_sbutton').hide();
                    $('.ewallet_abutton').removeClass('hide').show();
                }
                $('#ewallet_form').attr('action', data.HtmlUri);
            });
        }

        function is_enrolled(enrolled) {
            if (enrolled) {
                $('.payment_panel').hide();
                $('.payment_panel_error').removeClass("hide");
            }
            else {
                $('.payment_panel').show();
                $('.payment_panel_error').addClass("hide");
            }
        }

        $(document).ready(function () {
            if ($('.offerbox').size() > 1) {
                $('.offerbox').eq(1).addClass('active');
                update_recur($('.offerbox').eq(1).data('recur'));
                checkbalance($('.offerbox').eq(1).data('pid'));
                is_enrolled($('.offerbox').eq(1).data('allowed'));
                $.each($('.offerbox').eq(1).data(), function (x, y) {
                    $("input[name='" + x + "']").val(y);
                });
            }
            else {
                $('.offerbox').first().addClass('active');
                update_recur($('.offerbox').first().data('recur'));
                checkbalance($('.offerbox').first().data('pid'));
                is_enrolled($('.offerbox').first().data('allowed'));
                $.each($('.offerbox').first().data(), function (x, y) {
                    $("input[name='" + x + "']").val(y);
                });
            }
            $('.offerbox').click(function (e) {
                e.preventDefault();
                $('.offerbox').removeClass('active');
                $(this).addClass('active');
                update_recur($(this).data('recur'));
                is_enrolled($(this).data('allowed'));
                $.each($(this).data(), function (x, y) {
                    $("input[name='" + x + "']").val(y);
                });
            });
        });
    </script>
    <script type="text/javascript">
        /* warn page reloading */
        /*if (needConfirm || $('#subProMsg').is(':visible')) */
        var needConfirm = false;
        function askConfirm() {
            if (needConfirm) {
                return 'The system is currently processing your request. Leaving this page might cause some problems.';
            }
        }
        $("select, input, textarea").change(function () {
            needConfirm = true;
        });

        $(document).ready(function () {
            window.onbeforeunload = askConfirm;
        });

        $("form").submit(function () {
            needConfirm = false;
        });
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.offerboxs .offerbox').click(function () {
                checkbalance($(this).data('pid'));
                return false;
            });
        });
    </script>
    @{if (ErrorMessage != null)
    {
        if (String.Compare(ErrorMessage.info, "PrepaidCard", true) == 0)
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#prepaidcard_body').addClass('in');
                    $('html, body').animate({ scrollTop: $('#prepaid_card_anchor').offset().top }, 'slow');
                    return false;
                });
            </script>
        }
        else if (String.Compare(ErrorMessage.info, "CreditCard", true) == 0)
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#creditcard_body').addClass('in');
                    $('html, body').animate({ scrollTop: $('#credit_card_anchor').offset().top }, 'slow');
                    return false;
                });
            </script>
        }
        else if (String.Compare(ErrorMessage.info, "EWallet", true) == 0)
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    $('#ewallet_body').addClass('in');
                    $('html, body').animate({ scrollTop: $('#ewallet_anchor').offset().top }, 'slow');
                    return false;
                });
            </script>
        }
    }
    }
    <script type="text/javascript">
        // on page script only for this page
        $(document).ready(function () {
            // whow bootstrap tooltip
            $("[data-toggle=tooltip]").tooltip();

            // for form light box
            $('form#paypal_form').submit(function (e) {
                var form = this;
                e.preventDefault();
                $('#subProMsg').modal({
                    keyboard: false,
                    backdrop: "static"
                });
                setTimeout(function () {
                    form.submit();
                }, 2000); // in milliseconds
            });
        });
    </script>
    @{
        if (IsFirstTimeSubscriber)
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    dataLayer.push({ 'pageview': '/user/subscribenewstart', 'pagetitle': 'New Subscription Start', 'event': 'vpv' });
                });
            </script>
        }
        else
        {
            <script type="text/javascript">
                $(document).ready(function () {
                    dataLayer.push({ 'pageview': '/user/subscriberenewalstart', 'pagetitle': 'Renewal Subscription Start', 'event': 'vpv' });
                });
            </script>
        }
    }

    @{if (IsPacMay)
    {
        <script type="text/javascript">
            var pid = $('.offerbox').eq(1).data('pid') == undefined ? $('.offerbox').eq(0).data('pid') : $('.offerbox').eq(1).data('pid');
            $('.offerboxs .offerbox').click(function () {
                pid = $(this).data('pid');
                return false;
            });
            $(document).ready(function () {
                $("#btnCancelRecurring").click(function () {
                    $.ajax({
                        type: "POST"
                    , data: { pid: pid }
                    , url: "/User/CancelRecurring"
                    , success: function (data) {
                        if (data.StatusCode == 0) {
                            $('.alert').removeClass('alert-danger').addClass('alert-success');
                            $('.fs_20px').html("Automatic Payment Renewal Cancellation was successful. You may now purchase this product. Reloading page...");
                            setTimeout(function () { window.location.reload(); }, 1000);
                        }
                        else {
                            $('.alert').removeClass('alert-success').addClass('alert-danger');
                            if (data.StatusMessage != "")
                                $('.fs_20px').html(data.StatusMessage);
                        }
                    }
                    });
                    return false;
                });
            });
        </script>
    }}

    <script type="text/javascript">
        $(document).ready(function () {
            // disable copy & paste in email field
            $('input[type=email]').bind('copy paste', function (e) {
                e.preventDefault();
            });

            // match "mail" with "confirm mail"
            $('#p_login_email_c').keyup(function () { confirmMail() });
            $('#p_login_email').keyup(function () { confirmMail() });
            $('#register_btn').click(function (e) { if (!confirmMail()) { e.preventDefault(); } });
        });

        function confirmMail() {  // match function
            var mail = $('#p_login_email').val();
            var confirm_mail = $('#p_login_email_c').val();
            if (mail != confirm_mail && mail != "" && confirm_mail != "") {
                $('#p_login_email_c').css('border', '1px solid red');
                $('#msg_confirm_email').html('<span class="err-confirm">Email addresses don\'t match</span>');
                return false;
            } else {
                $('#p_login_email_c').css('border', '1px solid #ccc');
                $('#msg_confirm_email').html('');
                return true;
            }
        }
    </script>

    <script type="text/javascript">
        $(function () {
            $("[data-hide]").on("click", function () {
                $("." + $(this).attr("data-hide")).addClass("hide");
            });
        });
    </script>

    @*<script type="text/javascript">
            $(document).ready(function () {
                $(".right_side_link").click(function () {
                    createCookie("redirect3178", true, 1);
                    return true;
                });
            });
        </script>*@
}
