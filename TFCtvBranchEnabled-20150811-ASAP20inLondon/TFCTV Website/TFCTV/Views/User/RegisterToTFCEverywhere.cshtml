@{
    ViewBag.Title = "Register to TFC Everywhere - TFC.tv";
    Layout = "~/Views/Shared/_TFCTVBlue.cshtml";

    string url = "/User/RegisterVerify";
    if (ViewBag.isConnectedToSocialNetworks != null)
    {
        bool isConnectedToSocialNetworks = Convert.ToBoolean(ViewBag.isConnectedToSocialNetworks);
        if (isConnectedToSocialNetworks)
        {
            url = GlobalConfig.RegistrationConfirmPage;
        }
    }
}
<div id="mainBody">
    <br />
    <br />
    <form id="tveform" method="post" action="/User/_ClaimTVEverywhere">
    <div class="transparentBg floatLeft">
        <div class="clear">
        </div>
        <div style="margin-bottom: -3px;">
            @Html.ImageBuilder(Url, "register/tve-banner-green-long.jpg", new { title = "TFC Everywhere", alt = "TFC Everywhere", width = 940 })</div>
        <div class="genericHeader">
            <div id="genericHeader_header">
                <div id="headerTitle" class="sectionHeaderTitle">
                    Register to TFC Everywhere</div>
                <div id="headerCategoryName" class="sectionHeader">
                </div>
            </div>
        </div>
        <div id="mainContainer">
            <div class="breakStandard">
            </div>
            <div class="padLeftLarge">
                <div class="subtext subheader">
                    Step 1. Enter either your TFC Set Top Box/Smart Card Number or your TFC Account
                    Number
                </div>
                <div class="breakStandard">
                </div>
            </div>
            <div class="breakStandard">
            </div>
            <!-- start here --->
            <div class="padLeftLarge">
                <div class="mainBox">
                    <div id="STB" class="frmContainer lmargin">
                        <div class="frmTitle centerText">
                            Set Top Box/Smart Card Number</div>
                        <div class="edit-row">
                            <input id="MacAddressOrSmartCard" name="MacAddressOrSmartCard" class="textbox accountinfo" /><span
                                class="errstatus eps"></span>
                        </div>
                        <div class="breakSmall">
                        </div>
                        <div class="centerText">
                            Set Top Box MAC ID or Smart Card number<br />
                            can be found in your Set Top Box or by going to System Settings.
                        </div>
                        <div class="breakSmall">
                        </div>
                        <div style="width: 320px; margin-left: -10px; font-size: 14px;">
                            <a href="#" class="orange boldText" id="guideStbLink">Guide to get your Smart Card Number</a>
                        </div>
                    </div>
                    <div class="ORBreak">
                        @Html.ImageBuilder(Url, "or-bar-small.png")
                    </div>
                    <div id="ANumber" class="frmContainer lmargin">
                        <div class="frmTitle centerText">
                            Customer Number</div>
                        <div class="edit-row">
                            <input id="AccountNumber" name="AccountNumber" class="textbox accountinfo" /><span
                                class="errstatus eps"></span>
                        </div>
                        <div class="centerText">
                            You can easily find your Customer Number
                            <br />
                            on your monthly TFC billing statement</div>
                    </div>
                </div>
            </div>
            <div class="breakLarge clear">
            </div>
            <div class="padLeftLarge">
                <div class="subtext subheader ansubheader">
                    Step 2. Enter your TFC Activation Code
                </div>
                <div class="breakStandard">
                </div>
            </div>
            <div class="padLeftLarge">
                <div id="ActivateNum" class="frmContainer">
                    <div class="frmTitle centerText">
                        Activation Code</div>
                    <div class="breakSmall">
                    </div>
                    <div class="edit-row">
                        <input id="ActivationNumber" name="ActivationNumber" class="textbox" /><span class="errstatus eps"></span>
                    </div>
                    <div class="breakSmall">
                    </div>
                    <div class="centerText">
                        To generate and claim your TFC Activation<br />
                        Code, click on the link below the field.
                    </div>
                    <div class="breakSmall">
                    </div>
                    <div style="width: 350px; margin-left: -10px; font-size: 14px;">
                        <a href="#" class="orange boldText" id="ResendTVEActivationCode">Request for your TFC
                            Activation Code</a>
                    </div>
                </div>
            </div>
            <div class="breakLarge clear">
            </div>
            <div class="padLeftLarge">
                <div id="tnc" class="white">
                    <input type="checkbox" id="terms" name="terms" value="0" />
                    I confirm that I have read and fully understand and accept the TFC Everywhere
                    @Html.ActionLink("Terms of Service and Acceptability Use Policy", "TermsAndConditionsTFCEverywhere", "Home")<br />
                    <span class="errstatus eps1"></span>
                </div>
            </div>
            <div class="breakLarge clear">
            </div>
            <div id="msg-area" class="hideElement">
            </div>
            <div class="breakLarge clear">
            </div>
            <div class="buttonArea sfmargin">
                <input type="submit" class="activate-now-tve-btn floatLeft" id="regsubmit" value="" />
            </div>
            <div class="breakLarge clear">
            </div>
        </div>
    </div>
    </form>
    <div class="breakLarge">
    </div>
    <div class="clear">
    </div>
</div>
<div id="ajaxloading" class="hideElement">
    <div id="spanner">
        @Html.ImageBuilder(Url, "ajax-loader.gif", new { id = "loading-xs", alt = "loading...", width = "20", height = "20" })
        <span id="spannertext">Please wait while we process your request. This might take a
            few minutes...</span>
    </div>
    <div class="breakSmall">
    </div>
</div>
<div class="modal" id="modal">
    <h2 class="title">
        Claim TFC Activation Code</h2>
    <p class="message">
    </p>
    <span class="floatRight"><a class="close">Close this window</a> </span>
</div>
<div id="cong-msg" class="hideElement">
    <p>
        Congratulations! Your TFC Activation Code has been successfully sent to you. You
        may view your Activation Code from any of the following options:
    </p>
    <p>
        <span class="redhigh">1. Check your email inbox.</span> A message with your TFC
        Activation Code has been sent to the email address that you have registered to TFC.tv
        and to any existing email address you submitted for your TFC Service. If this message
        is not in your inbox, kindly check the spam or junk folder of your email, as the
        email with the TFC Activation Code may have been sent there accidentally.
    </p>
    <p>
        <span class="redhigh">2. Turn on your TFC Service.</span> Your TFC Everywhere Activation
        will be sent to the Messaging Mailbox under My Account. Kindly wait for the message
        with your TFC Everywhere activation code to appear on your box (Applies to IPTV Set Top Box only).
    </p>
</div>
<div id="lreached" class="hideElement">
    <p>
        Invalid data entered. Please chat with our live support team for assistance:
    </p>
    <div>
        <a class="chat-live-now-btn" href="http://c.velaro.com/visitor/requestchat.aspx?siteid=8395&showwhen=inqueue&deptid=15390"
            target="_blank" onclick="this.newWindow = window.open('http://c.velaro.com/visitor/requestchat.aspx?siteid=8395&showwhen=inqueue&deptid=15390', 'Live Chat Software', 'toolbar=no,location=no,directories=no,menubar=no,status=no,scrollbars=no,resizable=yes,replace=no');this.newWindow.focus();this.newWindow.opener=window;return false;">
            CHAT</a>
    </div>
    @{if (String.Compare(MyUtility.GetCurrentCountryCodeOrDefault(), "US", true) == 0)
      {
        <p>
            or call our Customer Service at 18778846832</p>  
      }
    }
</div>
<div id="guide-to-stb" class="hideElement">
    <p>
        For Direct To Home (DTH) Subscribers, pick the model of your Set Top Box from those
        listed on the left for more instructions on how to locate your Smart Card Number.
    </p>
    <div>
        <div id="stb-images" class="floatLeft">
            <a class="stb-type stb-ir58 stb-selected" rel="ir58-copy">IR58</a><a class="stb-type stb-smp"
                rel="smp-copy">SMP</a><a class="stb-type stb-ts" rel="ts-copy">TS</a>
        </div>
        <div id="stb-instructions">
            <div class="ir58-copy stb-copies">
                <h1>
                    IR58</h1>
                <p>
                    If you have the IR58 model, follow the steps below:
                </p>
                <ul class="stb-list">
                    <li>1. Press Menu</li>
                    <li>2. Select System Settings</li>
                    <li>3. Select CA Function</li>
                    <li>4. Select Information</li>
                    <li>5. Check SC Number</li>
                </ul>
            </div>
            <div class="smp-copy stb-copies hideElement">
                <h1>
                    SMP</h1>
                <p>
                    If you have the SMP model, follow the steps below:
                </p>
                <ul class="stb-list">
                    <li>1. Press Menu</li>
                    <li>2. Select System Information</li>
                    <li>3. Select IRD Status</li>
                    <li>4. Check SC Number</li>
                </ul>
            </div>
            <div class="ts-copy stb-copies hideElement">
                <h1>
                    TS</h1>
                <p>
                    If you have the TS model, follow the steps below:
                </p>
                <ul class="stb-list">
                    <li>1. Press Menu</li>
                    <li>2. Select Information</li>
                    <li>3. Select IRD Information</li>
                    <li>4. Check SC Number</li>
                </ul>
            </div>
        </div>
    </div>
</div>
<!-- end of list -->
@section Stylesheet
{
    @Html.CssBuilder(Url, "register.css")
    @Html.CssBuilder(Url, "tve.css?v1.1.1")
}
@section JScriptBottom {
    @Html.JsBuilder(Url, "jquery.validate.min.1.11.js")
    @Html.JsBuilder(Url, "additional-methods.min.js")
    <script type="text/javascript">
        var elist;
        $(document).ready(function () {
            var validator = $('form#tveform').validate({
                invalidHandler: function (event, validator) {
                    elist = validator;
                    var isShown = false;
                    var errors = validator.numberOfInvalids();
                    if (errors) {
                        var eList = '<ol style="margin-left: -20px;">';
                        $(elist.errorList).each(function (x, y) {
                            if (y.element.id == 'MacAddressOrSmartCard' || y.element.id == 'AccountNumber') {
                                if (!isShown) {
                                    eList += '<li>Please fill up the Set Top Box/Smart Card Number or Account Number</li>';
                                    isShown = true;
                                }
                            }
                            else
                                eList += '<li>' + y.message + '</li>';
                        });
                        eList += '</ol>';
                        $("#modal .message").html(eList);
                    }
                    validator.defaultShowErrors();
                },
                rules: {
                    ActivationNumber: {
                        required: true
                    },
                    terms: { required: true },
                    MacAddressOrSmartCard: {
                        require_from_group: [1, ".accountinfo"]
                    },
                    AccountNumber: {
                        require_from_group: [1, ".accountinfo"]
                    }
                },
                messages: {
                    MacAddressOrSmartCard: {
                        required: 'Set Top Box/Smart Card Number is required.'
                    },
                    AccountNumber: {
                        required: 'Account Number is required.'
                    },
                    ActivationNumber: {
                        required: 'Activation Code is required.'
                    },
                    terms: { required: 'Please read and accept TFC Everywhere Terms of Service and Acceptability Use Policy.' }
                },
                errorPlacement: function (error, element) {
                    error.appendTo(element.parent().find('.errstatus'));
                }
            });

            $('form#tveform').submit(function (event) {
                event.preventDefault();
                $('#modal').width(350);
                var title = 'Activation Information';
                var errorCode = 0;
                $('#modal .title').text(title);
                if (validator.numberOfInvalids() == 0) {
                    $('#msg-area').html($('#ajaxloading').html()).show();
                    var form = $(this);
                    $('input[type=submit]').attr('disabled', 'disabled');
                    $('*').css('cursor', 'progress');
                    $.post('/User/_ClaimTVEverywhere', form.find('input').serialize(), function (data) {
                        errorCode = data.errorCode;
                        if (data.errorCode == 0) {
                            $('#modal .message').html($('#cong-msg').html());
                            window.location.href = data.href;
                        }
                        else if (data.errorCode == -211) {
                            $('#modal .message').html($('#lreached').html());
                        }
                        else
                            $('#modal .message').html(data.errorMessage);
                    }).done(function () {
                        if (errorCode != 0)
                            $('#modal').overlay().load();
                        $('#msg-area').hide();
                        $('input[type=submit]').removeAttr('disabled');
                        $('*').css('cursor', 'auto');
                        $('a').removeAttr('style');
                    }); ;
                }
                else {
                    //$('#modal .message').html('Please fill in the required fields.');
                    $("#modal").overlay().load();
                }
            });

        });
    
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $("#modal").overlay({
                top: 80,
                mask: {
                    color: '#000',
                    loadSpeed: 200,
                    opacity: 0.5
                },
                closeOnClick: false
            });

            $('#ResendTVEActivationCode').click(function () {
                var title = 'Claim TFC Activation Code';
                $('#modal .title').text(title);
                $('#msg-area').html($('#ajaxloading').html()).show();

                var form = $('form#tveform');
                $.post('/User/_ResendTVEActivationCode', form.find('input').serialize(), function (data) {
                    if (data.errorCode == 0)
                        $('#modal .message').html($('#cong-msg').html());
                    else
                        $('#modal .message').html(data.errorMessage);

                }).done(function () {
                    $('#modal').width(350);
                    $("#modal").overlay().load();
                    $('#msg-area').hide();
                });
                return false;
            });


            $('#guideStbLink').click(function () {
                var title = 'Guide to get your Smart Card Number';
                $('#modal .title').text(title);
                $('#modal .message').html($('#guide-to-stb').html());
                $('#modal').width(640);
                $('.stb-ir58').addClass('stb-selected');
                $('.ir58-copy').removeClass('hideElement');
                $("#modal").overlay().load();
                return false;

            });

            $('.stb-type').on('click', function () {
                $('.stb-type').removeClass('stb-selected');
                $(this).addClass('stb-selected');
                $('.stb-copies').addClass('hideElement');
                var element = '.' + $(this).attr('rel');
                $(element).removeClass('hideElement');
                return false;
            });
        });
    </script>
}
