@{
    ViewBag.Title = "Reload via SmartPit - TFC.tv";
    Layout = "~/Views/Shared/_TFCTVBlue.cshtml";

    bool HasError = ViewBag.HasError;

    ViewBag.BreadCrumb = "ENROLL SMARTPIT CARD NUMBER";
    string SmartPitCardNumber = ViewBag.SmartPitCardNumber;
    if (!String.IsNullOrEmpty(SmartPitCardNumber))
    {
        ViewBag.BreadCrumb = "SMARTPIT";
    }

}
<br />
<br />
<div id="mainBody">
    <div class="transparentBg">
        <div id="transact-container">
            <div class="breadcrumbs">
                E-WALLET &raquo; RELOAD TYPE &raquo; @ViewBag.BreadCrumb
            </div>
            <div id="transact-body">
                <div id="payment-selection">
                    @Html.Action("ReloadSelection", new { pselection = "SmartPit" })
                </div>
                <div id="payment-main-container-2">
                    <div id="payment-main">
                        @{if (!HasError)
                          {
                              using (Html.BeginForm("_EnrollSmartPit", "Load", FormMethod.Post, new { enctype = "multipart/form-data", id = "form1" }))
                              { 
                            <div id="load-summary">
                                <div class="breakSmall">
                                    @Html.AntiForgeryToken()
                                </div>
                                <div id="ppc-purchase-instructions">
                                    <p>
                                        Maaari na kayong magbayad at mag-load sa pinakamalapit na SmartPit Payment Terminals
                                        ng Lawson at Familymart. I-type lang sa ilalim ang inyong SmartPit Card number para
                                        ma-connect ito sa inyong TFC.tv account.</p>
                                </div>
                                <div class="breakStandard">
                                </div>
                                @{if (String.IsNullOrEmpty(SmartPitCardNumber))
                                  {
                                    <div id="smartpit-main">
                                        <div class="copy">
                                            SmartPit Card Number:</div>
                                        <div>
                                            <input type="text" class="textbox" name="SmartPitCardNumber" id="SmartPitCardNumber"
                                                placeholder="SmartPit Card Number" maxlength="32" />
                                            <div class="errstatus ind165">
                                            </div>
                                        </div>
                                        <div class="clear breakSmall">
                                        </div>
                                        <div class="copy">
                                            &nbsp;
                                        </div>
                                        <div class="btn-container">
                                            <input type="submit" value="Submit" class="nbutton" /></div>
                                        <div class="clear breakLarge">
                                        </div>
                                        <div class="copy">
                                            &nbsp;
                                        </div>
                                        <div class="btn-container">
                                            Wala ka pang SmartPit Card Number? Click <a href="#" id="sp-generate">here</a> to
                                            generate</div>
                                    </div>
                                    <div class="breakLarge">
                                    </div>
                                    <div class="clear breakLarge">
                                    </div>                                
                                  }
                                  else
                                  {
                                  
                                    <div id="sp-summary-body">
                                        <div class="sp-card-summary">
                                            <div class="breakStandard">
                                            </div>
                                            <div class="title-no-indent">
                                                SmartPit Card Number</div>
                                            <div>
                                                <p class="sp-body-text">
                                                    @SmartPitCardNumber</p>
                                            </div>
                                            <div class="breakStandard">
                                            </div>
                                        </div>
                                    </div>
                                  }
                                }
                                <div class="clear">
                                </div>
                                <div id="summary-body">
                                    <div class="purchase-summary fold-top">
                                        <div class="breakStandard">
                                        </div>
                                        <div class="title">
                                            How to Use</div>
                                        <div>
                                            <ol>
                                                <li>Isulat ang SmartPit number na ito at dalhin sa pinakamalapit na Lawson o Familymart.<br />
                                                    <br />
                                                </li>
                                                <li>I-enter and number na ito sa SmartPit Payment Terminal ng Lawson o Familymart.<br />
                                                    <br />
                                                </li>
                                                <li>Piliin ang load amount na ¥1,000 at i-print ang resibo.<br />
                                                    <br />
                                                </li>
                                                <li>Dalhin ang resibo at magbayad sa counter.<br />
                                                    <br />
                                                </li>
                                                <li>Sa susunod na log-in mo sa TFC.tv, makikita mo na ang credits na binayaran mo. Maaari
                                                    ka nang bumili ng kahit anong show na nais mong panoorin.</li>
                                            </ol>
                                        </div>
                                        <div class="breakStandard">
                                        </div>
                                        <div class="title thelp">
                                            Need Help?</div>
                                        <div>
                                            <p class="thelp2 help">
                                                Visit our Customer <a href="/Help">Help Center</a><br />
                                                <br />
                                                <br />
                                                Email our Customer Service at <a href="mailto:support@tfc.tv">support@tfc.tv</a></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="clear breakLarge">
                                </div>
                            </div>
                              }
                          }
                          else
                          {
                            @Html.Action("ErrorEncountered", new { error = ViewBag.ErrorEncountered })
                          }
                        }
                        <div id="wait-time">
                            <div class="breakSmall">
                                <a id="wait-anchor"></a>
                            </div>
                            <div class="purchase-instructions">
                                <p>
                                    @Html.ImageBuilder(Url, "3.gif", new { style = "position: relative; top: 5px;" })
                                    Please wait while we process your request...
                                </p>
                            </div>
                        </div>
                        <div id="tcomplete" class="hideElement">
                            <div class="breakSmall">
                            </div>
                            <div class="purchase-instructions">
                                <p>
                                    Congratulations! You have successfully completed this transaction.</p>
                            </div>
                        </div>
                        <div id="errorContainer" class="hideElement">
                            <div class="msgbox-header">
                                <p>
                                    Oops! Something went wrong with your transaction.</p>
                            </div>
                            <div class="breakStandard">
                            </div>
                            <div id="msgbox-content" class="msgbox-content ui-state-error">
                            </div>
                            <div class="breakStandard">
                            </div>
                            <div>
                                <input type="button" id="try-again" value="Click here to try again" class="nbutton" />
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="clear">
            </div>
        </div>
    </div>
</div>
@section Stylesheet {
    @Html.CssBuilder(Url, "transaction-1.6.css")
    <!--[if IE 7]>
    @Html.CssBuilder(Url, "transaction.ie7-1.1.css")
    <![endif]-->
    <meta name="robots" content="nofollow" />
}
@section JScriptBottom {
    <script type="text/javascript">
        $(document).ready(function () {
            $('form#form1').submit(function (event) {
                event.preventDefault();
                $('#errorContainer').hide();
                $('#load-summary').fadeOut(500, function () {
                    $('#wait-time').fadeIn();
                    $('html, body').animate({
                        scrollTop: $('#entertainmentBtn').offset().top
                    }, 800);
                });
                var form = $(this);
                $.post($(this).attr('action'), form.find('input, select').serialize(), function (data) {
                    if (data.StatusCode == 0)
                        setTimeout(function () { $('#wait-time').hide(); $('#tcomplete').show(); location.reload(); }, 800);
                    else {
                        setTimeout(function () {
                            $('#msgbox-content').html(data.StatusMessage);
                            $('#wait-time').fadeOut(500, function () {
                                $('#errorContainer').fadeIn();
                                $('html, body').animate({
                                    scrollTop: $('#entertainmentBtn').offset().top
                                }, 800);
                            });
                        }, 800);
                    }
                }).fail(function () {
                    setTimeout(function () {
                        $('#msgbox-content').html("Error requesting page: " + form.attr('action'));
                        $('#wait-time').fadeOut(500, function () {
                            $('#errorContainer').fadeIn();
                            $('html, body').animate({
                                scrollTop: $('#entertainmentBtn').offset().top
                            }, 800);
                        });
                    }, 800);
                });
            });

            $('#sp-generate').click(function (event) {
                event.preventDefault();
                $('form#form1').submit();
            });
        });    
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#try-again').click(function () {
                location.reload();
                return false;
            });
        });
    </script>
    <script type="text/javascript">
        //onbeforeunload
        window.onbeforeunload = function () {
            var msg = '';
            if ($('#wait-time').is(':visible'))
                msg = 'The system is currently processing your request. Leaving this page might cause some problems.';
            if (msg != '')
                return msg;
        };
    </script>
}
